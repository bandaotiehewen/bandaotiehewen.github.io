<?xml version="1.0" encoding="utf-8"?>
<search>
  
    
    <entry>
      <title><![CDATA[Ubuntu下安装openvpn]]></title>
      <url>%2F2018%2F04%2F27%2Fopenvpn%2F</url>
      <content type="text"><![CDATA[以前波哥搭建的openvpn因为服务器到期就被关停了，然后现在不能访问服务器中只开放了内网访问地址的数据库，所有需要自己搭建一个openvpn。开始在网上搜索找到的是pptpd，安装运行简单，但说可能不稳定，而且之前用的也是openvpn的客户端，所以重新搭建安装openvpn，在此记录下过程，大部分是别人博客内容中的搬运，但也算是一种体验。 安装openvpn首先，在服务器端安装 OpenVPN 服务。我们可以很方便地通过 apt-get 安装，另外我们也需要安装easy-rsa： $ apt-get install openvpn $ apt-get install easy-rsa 安装成功后，拷贝“easy-rsa”到openvpn文件夹，并进入到该目录： $ make-cadir ~/openvpn-ca $ cd ~/openvpn-ca 也相当于如下的命令： $ cd /home/username/ $ mkdir openvpn-ca $ cp -r /usr/share/easy-rsa/* /home/username/openvpn-ca 配置CA变量进入 openvpn-ca 目录之后，用 vim (或者任意编辑器) 打开 vars 文件，到最后一部分，你将会看到如下内容： . . . export KEY_COUNTRY=&quot;US&quot; export KEY_PROVINCE=&quot;CA&quot; export KEY_CITY=&quot;SanFrancisco&quot; export KEY_ORG=&quot;Fort-Funston&quot; export KEY_EMAIL=&quot;me@myhost.mydomain&quot; export KEY_OU=&quot;MyOrganizationalUnit&quot; . . . 修改为任意你想要修改的值，只要不留空就好了： . . . export KEY_COUNTRY=&quot;CN&quot; export KEY_PROVINCE=&quot;SiChuan&quot; export KEY_CITY=&quot;Chengdu&quot; export KEY_ORG=&quot;wsn&quot; export KEY_EMAIL=&quot;what@the.fuck&quot; export KEY_OU=&quot;Community&quot; . . . 然后，还需要将 KEY_NAME 改为你喜欢的，这里简单起见，我们改成 server：（如果不改成server，在下面有个命令生成服务器配置文件需要注意更换） export KEY_NAME=&quot;server&quot; 然后，保存并关闭文件。 构建 Certificate Authority在刚才的目录中，执行 source vars ，然后，你将会看到如下输出： NOTE: If you run ./clean-all, I will be doing a rm -rf on /home/xlzd/openvpn-ca/keys 然后执行： $ ./clean-all $ ./build-ca 这将会启动创建根证书颁发密钥、证书的过程。由于我们刚才修改了 vars 文件，所有值应该都会自动填充。所以，一路回车就好了。这时会显示输出之前新更改的配置信息。到此，我们就有了创建以下步骤需要的 CA 证书。 创建服务器端证书、密钥和加密文件执行 ./build-key-server server 命令(此处的server与上面export KEY_NAME=”server”一致)，制作过程中一路回车，中间出现 challenge password ，不要输入任何值回车就行，最后的会有两个问题，你需要输入两次 y 注册证书和提交： . . . Certificate is to be certified until May 1 17:51:16 2026 GMT (3650 days) Sign the certificate? [y/n]:y 1 out of 1 certificate requests certified, commit? [y/n]y Write out database with 1 new entries Data Base Updated 然后还需要生成一些其他东西，在终端执行 ./build-dh，这个操作大约会花费几分钟不等。然后，我们可以生成 HMAC 签名加强服务器的 TLS 完整性验证功能： $openvpn --genkey --secret keys/ta.key 生成客户端证书、密钥对这一步之后可能会执行多次以生成不同的证书，这里我们以 client_one 作为第一组密钥对的名字： $cd ~/openvpn-ca $source vars $./build-key client_one 跟刚才一样，一路回车就好。如果你想生成一个带密码保护的凭证，可以使用build-key-pass命令： $cd ~/openvpn-ca $source vars $./build-key-pass client_one 配置 OpenVPN 服务首先，复制文件到 OpenVPN 的目录下： $ cd ~/openvpn-ca/keys $ sudo cp ca.crt ca.key server.crt server.key ta.key dh2048.pem /etc/openvpn 然后，复制并解压一个 OpenVPN 的配置示例： $cp /usr/share/doc/openvpn/examples/sample-config-files/server.conf.gz /etc/openvpn/ $cd /etc/openvpn $gunzip -d /etc/openvpn/server.conf.gz 然后更改server.conf中的配置： #这里是重点，必须指定SSL/TLS root certificate (ca), #certificate(cert), and private key (key) #ca文件是服务端和客户端都必须使用的，但不需要ca.key #服务端和客户端指定各自的.crt和.key #请注意路径,可以使用以配置文件开始为根的相对路径, #也可以使用绝对路径 #请小心存放.key密钥文件 ca ca.crt cert server.crt（与export KEY_NAME=&quot;server&quot;一致） key server.key（与export KEY_NAME=&quot;server&quot;一致） dh dh2048.pem #取消前面的;注释，这样可以使客户端的所有流量都必须经过VPN转发 push &quot;redirect-gateway def1 bypass-dhcp&quot; #取消前面的;注释，并设置DNS服务器的地址，该DNS信息将推送到 #客户端并设置到TAP网卡中 push &quot;dhcp-option DNS 223.5.5.5&quot; push &quot;dhcp-option DNS 114.114.114.114&quot; #再找到 tls-auth 位置，去掉注释，并在下面新增一行 tls-auth ta.key 0 # This file is secret key-direction 0 #取消前面的;注释，使客户端之间可以互通，根据实际需要决定是否 #开启，默认客户端之间是不能直接通讯的 client-to-client duplicate-cn user nobody group nogroup #取消前面的;注释，并设置log保存的位置 log openvpn.log 调整服务器网络配置允许IP转发编辑 /etc/sysctl.conf 文件，去掉 net.ipv4.ip_forward 设置前的注释： net.ipv4.ip_forward=1 输入 sudo sysctl -p 以读取文件并对当前会话生效。 调整 UFW 规则iptables -t nat -A POSTROUTING -s 10.8.0.0/24 -o eth0 -j MASQUERADE （通用方法，自动获取eth0网卡的IP地址） 其中eth0是内网地址，这个也是保证能够ping通内网的其他服务器的保证。 接着需要修改 /etc/default/ufw 文件，找到 DEFAULT_FORWARD_POLICY 设置，修改为： DEFAULT_FORWARD_POLICY=&quot;ACCEPT&quot; 打开 OpenVPN 端口并使变化生效执行下面的命令： $ sudo ufw allow 1194/udp $ sudo ufw disable $ sudo ufw enable 启动 OpenVPNservice openvpn restart 客户端配置然后将服务器端生成的证书和密钥文件，在/home/username/openvpn-ca文件夹下（ca.crt，client_one.crt，client_one.key，ta.key）下载到本地。以及/usr/share/doc/openvpn/examples/sample-config-files/client.conf文件下载到本地，然后修改client.conf为client.ovpn，并且更改其中配置： client #指明这是客户端 dev tun #基于路由的隧道 proto udp #采用UDP协议 remote 222.214.XXX.XXX 1194 #服务端IP及端口号 ca ca.crt #证书及密钥们 cert client_one.crt(一定与自己的文件名吻合) key client_one.key(一定与自己的文件名吻合) tls-auth ta.key 1 #TLS密钥，1表示客户端 key-direction 1 #新增 安装主要参考：怎样在 Ubuntu 16.04 上安装 OpenVPN 服务(转自知乎)与烂泥：ubuntu 14.04搭建OpenVPN服务器 配置文件：烂泥：openvpn配置文件详解 ping同内网服务器：烂泥：openvpn tun模式下客户端与内网机器通信]]></content>
    </entry>

    
    <entry>
      <title><![CDATA[Windows安装pytorch]]></title>
      <url>%2F2018%2F04%2F15%2FWindows%E5%AE%89%E8%A3%85pytorch%2F</url>
      <content type="text"><![CDATA[简介官网现在不能在Windows下安装pytorch（计划0.4版本后开始支持），但为了能在电脑上方便使用pycharm调写代码，发现知乎用户蒲嘉宸在维护编译好的Windows安装包，直接在anaconda3环境下就可以安装使用。本文也参考了他的知乎文章的一些内容。 安装条件作者提供了不同的安装包针对不同的环境，但有一些基本的条件需要注意： Anaconda3 x64 (with Python 3.5/3.6) Windows 64位系统（Windows 7 或 Windows Server 2008 及以上） GPU版本还需要任意版本的 CUDA （包内置了CUDA 8 / 9 的部分主要二进制文件） 如果没有GPU的话，只是为了快速上手可以使用cpu版本。为了加快conda的安装速度，可以使用清华的源 conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/ conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/ conda config --set show_channel_urls yes 安装conda包可以通过在线直接安装，但作者提供百度云直接下载安装文件本地安装，快速便捷。如果电脑有cuda和cudnn的支持，可以选择带有cuda和cudnn标识的版本，如果没有就安装只是cpu标识的版本。经过本人测试发现，cuda的capacity值需要大于5才能支持使用，如果过下，依然代码可以通过，但是无法使用GPU加速。但是如果没有cuda的GPU，就会报错，这时就只能coda remove pytorch然后重新安装cpu版本。安装代码如下： cd &quot;下载包的路径&quot; conda install numpy mkl cffi conda install pytorch????.tar.bz2 如果出现以下的错误提示，就是很可能GPU不支持，马上更换为cpu版本。 Traceback (most recent call last): File &quot;test.py&quot;, line 2, in &lt;module&gt; import torch File &quot;C:\Anaconda3\lib\site-packages\torch\__init__.py&quot;, line 41, in &lt;module&gt; from torch._C import * ImportError: DLL load failed: The specified module could not be found. 测试代码# CUDA TEST import torch x = torch.Tensor([1.0]) xx = x.cuda() print(xx) # CUDNN TEST from torch.backends import cudnn print(cudnn.is_acceptable(xx)) 如果CUDA工作不正常，那就不能使用.cuda()将模型和数据通过GPU进行加速了。而如果cuDNN不能正常工作，那就使用如下代码关掉它： cudnn.enabled = False 安装torchvisionTorchvision不是pytorch的一部分内容，是Python的另外一个包，需要用pip来安装，使用conda是安装不了的。但如果直接使用pip install torchvision安装可能会出错，经过查询资料应该使用pip install –no-deps torchvision命令，而很多其他不知道哪儿抄来的博客写的是pip install no-deps torchvision，坑人不浅 测试pytorch是否安装成功为了初步尝试pytorch在本地电脑的使用体验，可以去官方下载例子，也可以使用这个fashion-mnist例子来运行体验下本地测试的性能速度。 收获Windows的cmd太难用了，查询一款超好用的本地命令行终端cmder，颜值可功能都友好，同时支持一些Linux的命令操作，更加的方便操作。]]></content>
    </entry>

    
  
  
</search>
